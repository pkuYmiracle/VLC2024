# 实验数据

最快可以实现 1kHZ 的收发，理论上可以再低，但是收到的数据会较为不稳定。
原因可能是因为：

1. 光电感应装置采样频率的限制。（测试了10khz时钟的接收端，实际只能达到3khz的采样频率，因为dma传输不可能耗时如此久，所以猜测是 ADC Poll 的限制）
2. 普通液晶本身闪烁频率的限制（因为寒假要回家，所以没法拿到铁电液晶）（1khz 时的液晶已经无法明显地显示中间亮度）。
3. 采样过快导致读取数据时的offset不能很好的对齐。
4. 串口读取过快导致缓冲区溢出。（后面在host采用了buffer，较好地解决了这一问题）

## 间隔法

由于 1kHZ 的液晶无法明显显示中间亮度，所以间隔法将液晶闪烁频率设置为了 250 Hz，即 4ms 闪烁一次。
实验证明，间隔法能够明确地收发数据。

encoded_len=origin_len*2+data_len(16)+begin_symbols(48)

| origin data len(bit) | encoded data len(bit) | transmission time(s) | bit rate(bit/s) |
| -------------------- | --------------------- | -------------------- | --------------- |
| 16                   | 96                    | 0.38412              | 41.654          |
| 80                   | 224                   | 0.89609              | 89.277          |
| 400                  | 464                   | 1.85592              | 215.526         |


后面的几种编码会在物理层的编码前先对原始数据做加密处理，所以编码后的长度会膨胀。

## NRZL/NRZI

由于无法准确恢复时钟，所以 NRZL/NRZI 事实上并不能准确传递数据，所以在实验中我们只是简单地测试了传输速率。

| origin data len(bit) | encoded data len(bit) | transmission time(s) | bit rate(bit/s) |
| -------------------- | --------------------- | -------------------- | --------------- |
| 16                   | 672                   | 0.67220              | 23.802          |
| 80                   | 768                   | 0.76924              | 103.999         |
| 400                  | 1280                  | 1.28004              | 312.490         |
| 800                  | 1920                  | 1.91937              | 416.803         |
| 80000                | 128640                | 127.893              | 525.523         |

## Manchester

| origin data len(bit) | encoded data len(bit) | transmission time(s) | bit rate(bit/s) |
| -------------------- | --------------------- | -------------------- | --------------- |
| 16                   | 1344                  | 1.34275              | 11.816          |
| 80                   | 1536                  | 1.54023              | 51.940          |
| 400                  | 2560                  | 2.56331              | 156.048         |
| 800                  | 3840                  | 3.83894              | 208.391         |
| 80000                | 257280                | 258.211              | 309.824         |

## 4B/5B

由于编码层的实现有点问题，所以只能测传输速率。
| origin data len(bit) | encoded data len(bit) | transmission time(s) | bit rate(bit/s) |
| -------------------- | --------------------- | -------------------- | --------------- |
| 16                   | 840                   | 0.83991              | 19.050          |
| 80                   | 960                   | 0.96075              | 83.268          |
| 400                  | 1600                  | 1.60719              | 248.882         |
| 800                  | 2400                  | 2.50002              | 319.997         |
| 80000                | 160800                | 161.103              | 496.577         |

## Miller

| origin data len(bit) | encoded data len(bit) | transmission time(s) | bit rate(bit/s) |
| -------------------- | --------------------- | -------------------- | --------------- |
| 16                   | 1344                  | 1.40202              | 11.412          |
| 80                   | 1536                  | 1.54037              | 51.936          |
| 400                  | 2560                  | 2.72230              | 146.935         |
| 800                  | 3840                  | 3.87501              | 206.451         |
| 80000                | 257280                | 259.389              | 308.417         |
